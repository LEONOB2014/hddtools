<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-dark.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <title>hddtools by cvitolo</title>
  </head>

  <body>
    <div id="container">
      <div class="inner">

        <header>
          <h1>hddtools</h1>
          <h2>Hydrological Data Discovery Tools (R package)</h2>
        </header>

        <section id="downloads" class="clearfix">
          <a href="https://github.com/cvitolo/r_hddtools/zipball/master" id="download-zip" class="button"><span>Download .zip</span></a>
          <a href="https://github.com/cvitolo/r_hddtools/tarball/master" id="download-tar-gz" class="button"><span>Download .tar.gz</span></a>
          <a href="https://github.com/cvitolo/r_hddtools" id="view-on-github" class="button"><span>View on GitHub</span></a>
        </section>

        <hr>

        <section id="main_content">
          <h1>
<a id="hddtools-r-package" class="anchor" href="#hddtools-r-package" aria-hidden="true"><span class="octicon octicon-link"></span></a>HDDTOOLS (R package)</h1>

<p><a href="http://dx.doi.org/10.5281/zenodo.14721"><img src="https://zenodo.org/badge/doi/10.5281/zenodo.14721.svg" alt="DOI"></a></p>

<p>HDDTOOLS stands for Hydrological Data Discovery Tools. This R package is an open source project designed to facilitate non-programmatic access to avariety of online open data sources relevant for hydrologists and, more in general, environmental scientists and practitioners. </p>

<p>This typically implies the download of a metadata catalogue, selection of information needed, formal request for dataset(s), de-compression, conversion, manual filtering and parsing. All those operation are made more efficient by re-usable functions. </p>

<p>Depending on the data license, functions can provide offline and/or online modes. When redistribution is allowed, for instance, a copy of the dataset is cached within the package and updated twice a year. This is the fastest option and also allows offline use of package's functions. When re-distribution is not allowed, only online mode is provided.</p>

<p><strong>To cite this software:</strong><br>
Vitolo C., Hydrological Data Discovery Tools (hddtools, R package), (2014), GitHub repository, <a href="https://github.com/cvitolo/r_hddtools">https://github.com/cvitolo/r_hddtools</a>, doi: <a href="http://dx.doi.org/10.5281/zenodo.14721">http://dx.doi.org/10.5281/zenodo.14721</a></p>

<h1>
<a id="basics" class="anchor" href="#basics" aria-hidden="true"><span class="octicon octicon-link"></span></a>Basics</h1>

<p>First, install all the dependencies:</p>

<div class="highlight highlight-source-r"><pre>install.packages(c(<span class="pl-s"><span class="pl-pds">"</span>sp<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>rgdal<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>raster<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>RCurl<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>XML<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>zoo<span class="pl-pds">"</span></span>,
                   <span class="pl-s"><span class="pl-pds">"</span>devtools<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>XML2R<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>rjson<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>stringr<span class="pl-pds">"</span></span>))
library(<span class="pl-smi">devtools</span>)
install_github(<span class="pl-s"><span class="pl-pds">"</span>cvitolo/r_rnrfa<span class="pl-pds">"</span></span>, <span class="pl-v">subdir</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>rnrfa<span class="pl-pds">"</span></span>)</pre></div>

<p>The stable version (preferred option) of hddtools is available from CRAN (<a href="http://www.cran.r-project.org/web/packages/hddtools/index.html">http://www.cran.r-project.org/web/packages/hddtools/index.html</a>):</p>

<div class="highlight highlight-source-r"><pre>install.packages(<span class="pl-s"><span class="pl-pds">"</span>hddtools<span class="pl-pds">"</span></span>)</pre></div>

<p>The development version is, instead, on github and can be installed via devtools:</p>

<div class="highlight highlight-source-r"><pre>install_github(<span class="pl-s"><span class="pl-pds">"</span>cvitolo/r_hddtools<span class="pl-pds">"</span></span>, <span class="pl-v">subdir</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>hddtools<span class="pl-pds">"</span></span>)
library(<span class="pl-smi">hddtools</span>)</pre></div>

<p>Source the additional function GenerateMap():</p>

<div class="highlight highlight-source-r"><pre>source_gist(<span class="pl-s"><span class="pl-pds">"</span>https://gist.github.com/cvitolo/f9d12402956b88935c38<span class="pl-pds">"</span></span>)</pre></div>

<h1>
<a id="data-sources-and-functions" class="anchor" href="#data-sources-and-functions" aria-hidden="true"><span class="octicon octicon-link"></span></a>Data sources and Functions</h1>

<p>The functions provided can filter, slice and dice 2 and 3 dimensional information. </p>

<div class="highlight highlight-source-r"><pre><span class="pl-c"># Define a bounding box</span>
<span class="pl-smi">bbox</span> <span class="pl-k">&lt;-</span> <span class="pl-k">list</span>(<span class="pl-v">lonMin</span><span class="pl-k">=</span><span class="pl-k">-</span><span class="pl-c1">10</span>,<span class="pl-v">latMin</span><span class="pl-k">=</span><span class="pl-c1">48</span>,<span class="pl-v">lonMax</span><span class="pl-k">=</span><span class="pl-c1">5</span>,<span class="pl-v">latMax</span><span class="pl-k">=</span><span class="pl-c1">62</span>)

<span class="pl-c"># Define a temporal extent</span>
<span class="pl-smi">timeExtent</span> <span class="pl-k">&lt;-</span> seq(as.Date(<span class="pl-s"><span class="pl-pds">"</span>2012-01-01<span class="pl-pds">"</span></span>), as.Date(<span class="pl-s"><span class="pl-pds">"</span>2012-01-31<span class="pl-pds">"</span></span>), <span class="pl-v">by</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>months<span class="pl-pds">"</span></span>)</pre></div>

<h2>
<a id="the-koppen-climate-classification-map" class="anchor" href="#the-koppen-climate-classification-map" aria-hidden="true"><span class="octicon octicon-link"></span></a>The Koppen Climate Classification map</h2>

<p>The Koppen Climate Classification is the most widely used system for classifying the world's climates. Its categories are based on the annual and monthly averages of temperature and precipitation. It was first updated by Rudolf Geiger in 1961, then by Kottek et al. (2006), Peel et al. (2007) and then by Rubel et al. (2010). </p>

<p>The package hddtools contains a function to identify the updated Koppen-Greiger climate zone, given a bounding box.</p>

<div class="highlight highlight-source-r"><pre><span class="pl-c"># Extract climate zones from Peel's map:</span>
KGClimateClass(<span class="pl-smi">bbox</span>,<span class="pl-v">updatedBy</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>Peel<span class="pl-pds">"</span></span>)

<span class="pl-c"># Extract climate zones from Kottek's map:</span>
KGClimateClass(<span class="pl-smi">bbox</span>,<span class="pl-v">updatedBy</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>Kottek<span class="pl-pds">"</span></span>)</pre></div>

<h2>
<a id="the-global-runoff-data-centre" class="anchor" href="#the-global-runoff-data-centre" aria-hidden="true"><span class="octicon octicon-link"></span></a>The Global Runoff Data Centre</h2>

<p>The Global Runoff Data Centre (GRDC) is an international archive hosted by the Federal Institute of Hydrology (Bundesanstalt für Gewässerkunde or BfG) in Koblenz, Germany. The Centre operates under the auspices of the World Meteorological Organisation and retains services and datasets for all the major rivers in the world.</p>

<p>Catalogue, kml files and the product ``Long-Term Mean Monthly Discharges'' are open data and accessible via the hddtools.</p>

<div class="highlight highlight-source-r"><pre><span class="pl-c"># GRDC full catalogue</span>
<span class="pl-smi">x</span> <span class="pl-k">&lt;-</span> GRDC_Catalogue()

<span class="pl-c"># Filter GRDC catalogue based on a bounding box</span>
<span class="pl-smi">x</span> <span class="pl-k">&lt;-</span> GRDC_Catalogue(<span class="pl-v">bbox</span><span class="pl-k">=</span><span class="pl-smi">bbox</span>, <span class="pl-v">metadataColumn</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>statistics<span class="pl-pds">"</span></span>, <span class="pl-v">entryValue</span><span class="pl-k">=</span><span class="pl-c1">1</span>)

<span class="pl-c"># Plot a map</span>
GenerateMap(<span class="pl-smi">x</span>)

<span class="pl-c"># Monthly data extraction</span>
<span class="pl-smi">y</span> <span class="pl-k">&lt;-</span> GRDC_TS(<span class="pl-v">stationID</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>6122300<span class="pl-pds">"</span></span>, <span class="pl-v">plotOption</span><span class="pl-k">=</span><span class="pl-c1">TRUE</span>)</pre></div>

<h2>
<a id="nasas-tropical-rainfall-measuring-mission-trmm-only-available-for-github-version" class="anchor" href="#nasas-tropical-rainfall-measuring-mission-trmm-only-available-for-github-version" aria-hidden="true"><span class="octicon octicon-link"></span></a>NASA's Tropical Rainfall Measuring Mission (TRMM, only available for github version)</h2>

<p>The Tropical Rainfall Measuring Mission (TRMM) is a joint mission between NASA and the Japan Aerospace Exploration Agency (JAXA) that uses a research satellite to measure precipitation within the tropics in order to improve our understanding of climate and its variability.</p>

<p>The TRMM satellite records global historical rainfall estimation in a gridded format since 1998 with a daily temporal resolution and a spatial resolution of 0.25 degrees. This information is openly available for educational purposes and downloadable from an FTP server.</p>

<p>The hddtools provides a function, called \verb|TRMM()|, to download and convert a selected portion of the TRMM dataset into a raster-brick that can be opened in any GIS software.</p>

<div class="highlight highlight-source-r"><pre><span class="pl-c"># Retreive mean monthly precipitations from 3B43_V7 (based on a bounding box and time extent)</span>
TRMM(<span class="pl-smi">bbox</span>,<span class="pl-smi">timeExtent</span>)
plot(raster(<span class="pl-s"><span class="pl-pds">"</span>~/trmm_acc.tif<span class="pl-pds">"</span></span>))
<span class="pl-c"># or</span>
<span class="pl-smi">b</span> <span class="pl-k">&lt;-</span> brick(<span class="pl-s"><span class="pl-pds">"</span>~/trmm_acc.tif<span class="pl-pds">"</span></span>)
plot(<span class="pl-smi">b</span>)</pre></div>

<h2>
<a id="top-down-modelling-working-group" class="anchor" href="#top-down-modelling-working-group" aria-hidden="true"><span class="octicon octicon-link"></span></a>Top-Down modelling Working Group</h2>

<p>The Top-Down modelling Working Group (TDWG) for the Prediction in Ungauged Basins (PUB) Decade (2003-2012) is an initiative of the International Association of Hydrological Sciences (IAHS) which collected datasets for hydrological modelling free-of-charge, available <a href="http://tdwg.catchment.org/datasets.html">here</a>. This package provides a common interface to retrieve, browse and filter information.</p>

<h3>
<a id="the-data60uk-dataset-this-wont-work-as-the-server-is-down-from-december-2014" class="anchor" href="#the-data60uk-dataset-this-wont-work-as-the-server-is-down-from-december-2014" aria-hidden="true"><span class="octicon octicon-link"></span></a>The Data60UK dataset (This won't work as the server is down from December 2014)</h3>

<p>The Data60UK initiative collated datasets of areal precipitation and streamflow discharge across 61 gauging sites in England and Wales (UK). The database was prepared from source databases for research purposes, with the intention to make it re-usable. This is now available in the public domain free of charge. </p>

<p>The hddtools contain two functions to interact with this database: one to retreive the catalogue and another to retreive time series of areal precipitation and streamflow discharge.</p>

<div class="highlight highlight-source-r"><pre><span class="pl-c"># Data60UK full catalogue</span>
<span class="pl-smi">x</span> <span class="pl-k">&lt;-</span> Data60UKCatalogue()

<span class="pl-c"># Filter Data60UK catalogue based on bounding box</span>
<span class="pl-smi">bbox</span> <span class="pl-k">&lt;-</span> <span class="pl-k">list</span>(<span class="pl-v">lonMin</span><span class="pl-k">=</span><span class="pl-k">-</span><span class="pl-c1">3.82</span>,<span class="pl-v">latMin</span><span class="pl-k">=</span><span class="pl-c1">52.41</span>,<span class="pl-v">lonMax</span><span class="pl-k">=</span><span class="pl-k">-</span><span class="pl-c1">3.63</span>,<span class="pl-v">latMax</span><span class="pl-k">=</span><span class="pl-c1">52.52</span>)
<span class="pl-smi">x</span> <span class="pl-k">&lt;-</span> Data60UKCatalogue(<span class="pl-smi">bbox</span>)

<span class="pl-c"># Plot a map</span>
GenerateMap(<span class="pl-smi">x</span>)

<span class="pl-c"># Extract time series </span>
<span class="pl-smi">y</span> <span class="pl-k">&lt;-</span> Data60UKDailyTS(<span class="pl-c1">39015</span>, <span class="pl-v">plotOption</span><span class="pl-k">=</span><span class="pl-c1">TRUE</span>)

<span class="pl-c"># Extract time series for a specified teporal window</span>
<span class="pl-smi">timeExtent</span> <span class="pl-k">&lt;-</span> seq(as.Date(<span class="pl-s"><span class="pl-pds">"</span>1988-01-01<span class="pl-pds">"</span></span>), as.Date(<span class="pl-s"><span class="pl-pds">"</span>1989-12-31<span class="pl-pds">"</span></span>), <span class="pl-v">by</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>days<span class="pl-pds">"</span></span>)
<span class="pl-smi">y</span> <span class="pl-k">&lt;-</span> Data60UKDailyTS(<span class="pl-c1">39015</span>, <span class="pl-v">plotOption</span><span class="pl-k">=</span><span class="pl-c1">TRUE</span>, <span class="pl-smi">timeExtent</span>)</pre></div>

<h3>
<a id="mopex" class="anchor" href="#mopex" aria-hidden="true"><span class="octicon octicon-link"></span></a>MOPEX</h3>

<p>US dataset containing historical hydrometeorological data and river basin characteristics for hundreds of river basins from a range of climates throughout the world. </p>

<div class="highlight highlight-source-r"><pre><span class="pl-c"># MOPEX full catalogue</span>
<span class="pl-smi">x</span> <span class="pl-k">&lt;-</span> MOPEX_Catalogue()

<span class="pl-c"># Extract time series </span>
<span class="pl-smi">y</span> <span class="pl-k">&lt;-</span> MOPEX_TS(<span class="pl-s"><span class="pl-pds">"</span>14359000<span class="pl-pds">"</span></span>, <span class="pl-v">plotOption</span><span class="pl-k">=</span><span class="pl-c1">TRUE</span>)

<span class="pl-c"># Extract time series for a specified temporal window</span>
<span class="pl-smi">timeExtent</span> <span class="pl-k">&lt;-</span> seq(as.Date(<span class="pl-s"><span class="pl-pds">"</span>1948-01-01<span class="pl-pds">"</span></span>), as.Date(<span class="pl-s"><span class="pl-pds">"</span>1949-12-31<span class="pl-pds">"</span></span>), <span class="pl-v">by</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>days<span class="pl-pds">"</span></span>)
<span class="pl-smi">y</span> <span class="pl-k">&lt;-</span> MOPEX_TS(<span class="pl-s"><span class="pl-pds">"</span>14359000<span class="pl-pds">"</span></span>, <span class="pl-v">plotOption</span><span class="pl-k">=</span><span class="pl-c1">TRUE</span>, <span class="pl-smi">timeExtent</span>)</pre></div>

<h2>
<a id="sepa-river-level-data" class="anchor" href="#sepa-river-level-data" aria-hidden="true"><span class="octicon octicon-link"></span></a>SEPA river level data</h2>

<p>The Scottish Environment Protection Agency (SEPA) manages river level data for hundreds of gauging stations in the UK. The catalogue of stations was derived by an unofficial list (available here: <a href="http://pennine.ddns.me.uk/riverlevels/ConciseList.html">http://pennine.ddns.me.uk/riverlevels/ConciseList.html</a>). </p>

<div class="highlight highlight-source-r"><pre><span class="pl-c"># SEPA unofficial catalogue</span>
<span class="pl-smi">x</span> <span class="pl-k">&lt;-</span> SEPA_Catalogue()</pre></div>

<p>The time series of the last few days is available from SEPA website and downloadable using the following function:</p>

<div class="highlight highlight-source-r"><pre><span class="pl-c"># Single time series extraction</span>
<span class="pl-smi">y</span> <span class="pl-k">&lt;-</span> SEPA_TS(<span class="pl-v">hydroRefNumber</span><span class="pl-k">=</span><span class="pl-c1">234253</span>, <span class="pl-v">plotOption</span><span class="pl-k">=</span><span class="pl-c1">TRUE</span>)

<span class="pl-c"># Multiple time series extraction</span>
<span class="pl-smi">y</span> <span class="pl-k">&lt;-</span> SEPA_TS(<span class="pl-v">hydroRefNumber</span><span class="pl-k">=</span>c(<span class="pl-c1">234253</span>,<span class="pl-c1">234174</span>,<span class="pl-c1">234305</span>))
plot(<span class="pl-smi">y</span>[[<span class="pl-c1">1</span>]])
plot(<span class="pl-smi">y</span>[[<span class="pl-c1">2</span>]])
plot(<span class="pl-smi">y</span>[[<span class="pl-c1">3</span>]])</pre></div>

<h1>
<a id="warnings" class="anchor" href="#warnings" aria-hidden="true"><span class="octicon octicon-link"></span></a>Warnings</h1>

<p>This package and functions herein are part of an experimental open-source project. They are provided as is, without any guarantee.</p>

<h1>
<a id="please-leave-your-feedback" class="anchor" href="#please-leave-your-feedback" aria-hidden="true"><span class="octicon octicon-link"></span></a>Please leave your feedback</h1>

<p>I would greatly appreciate if you could leave your feedbacks either via email (<a href="mailto:cvitolodev@gmail.com">cvitolodev@gmail.com</a>) or taking a short survey <a href="https://www.surveymonkey.com/s/QQ568FT">here</a>.</p>
        </section>

        <footer>
          hddtools is maintained by <a href="https://github.com/cvitolo">cvitolo</a><br>
          This page was generated by <a href="https://pages.github.com">GitHub Pages</a>. Tactile theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.
        </footer>

                  <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-44379190-2");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>

      </div>
    </div>
  </body>
</html>
